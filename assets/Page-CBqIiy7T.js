import{g as oe,r as ne,u as H,b as i,C as se,c as I,s as ae,e as re,t as ie,v as le,w as ce,_ as O,x as de,z as me,A as fe,B as ue,D as pe,j as s,E as ge,F as ve,G as xe,H as he,I as be,y as B}from"./index-DueYcCxo.js";import{U as C,a as S,u as ye}from"./UserFormInput-DDSWd_Us.js";import{R as je,B as P,D as Ne}from"./form-CSrjPxGI.js";import{G as D,c as $e,d as Ce,e as Se,f as Ie,g as we}from"./index-B1VYJC3y.js";import{R as Ee,a as Me}from"./ExclamationCircleFilled-CGx5iNEx.js";import{R as ze}from"./CloseOutlined-CoqfB37s.js";import{F as Re}from"./index-1DX3mrbp.js";import"./index-CEmzOCpB.js";import"./SearchOutlined-BZ-2Z0Dm.js";import"./row-C7r7lR9E.js";const $=(t,o,n,e,a)=>({background:t,border:`${H(e.lineWidth)} ${e.lineType} ${o}`,[`${a}-icon`]:{color:n}}),Oe=t=>{const{componentCls:o,motionDurationSlow:n,marginXS:e,marginSM:a,fontSize:l,fontSizeLG:d,lineHeight:m,borderRadiusLG:g,motionEaseInOutCirc:f,withDescriptionIconSize:v,colorText:h,colorTextHeading:b,withDescriptionPadding:y,defaultPadding:c}=t;return{[o]:Object.assign(Object.assign({},ne(t)),{position:"relative",display:"flex",alignItems:"center",padding:c,wordWrap:"break-word",borderRadius:g,[`&${o}-rtl`]:{direction:"rtl"},[`${o}-content`]:{flex:1,minWidth:0},[`${o}-icon`]:{marginInlineEnd:e,lineHeight:0},"&-description":{display:"none",fontSize:l,lineHeight:m},"&-message":{color:b},[`&${o}-motion-leave`]:{overflow:"hidden",opacity:1,transition:`max-height ${n} ${f}, opacity ${n} ${f},
        padding-top ${n} ${f}, padding-bottom ${n} ${f},
        margin-bottom ${n} ${f}`},[`&${o}-motion-leave-active`]:{maxHeight:0,marginBottom:"0 !important",paddingTop:0,paddingBottom:0,opacity:0}}),[`${o}-with-description`]:{alignItems:"flex-start",padding:y,[`${o}-icon`]:{marginInlineEnd:a,fontSize:v,lineHeight:0},[`${o}-message`]:{display:"block",marginBottom:e,color:b,fontSize:d},[`${o}-description`]:{display:"block",color:h}},[`${o}-banner`]:{marginBottom:0,border:"0 !important",borderRadius:0}}},Be=t=>{const{componentCls:o,colorSuccess:n,colorSuccessBorder:e,colorSuccessBg:a,colorWarning:l,colorWarningBorder:d,colorWarningBg:m,colorError:g,colorErrorBorder:f,colorErrorBg:v,colorInfo:h,colorInfoBorder:b,colorInfoBg:y}=t;return{[o]:{"&-success":$(a,e,n,t,o),"&-info":$(y,b,h,t,o),"&-warning":$(m,d,l,t,o),"&-error":Object.assign(Object.assign({},$(v,f,g,t,o)),{[`${o}-description > pre`]:{margin:0,padding:0}})}}},Pe=t=>{const{componentCls:o,iconCls:n,motionDurationMid:e,marginXS:a,fontSizeIcon:l,colorIcon:d,colorIconHover:m}=t;return{[o]:{"&-action":{marginInlineStart:a},[`${o}-close-icon`]:{marginInlineStart:a,padding:0,overflow:"hidden",fontSize:l,lineHeight:H(l),backgroundColor:"transparent",border:"none",outline:"none",cursor:"pointer",[`${n}-close`]:{color:d,transition:`color ${e}`,"&:hover":{color:m}}},"&-close-text":{color:d,transition:`color ${e}`,"&:hover":{color:m}}}}},Ae=t=>({withDescriptionIconSize:t.fontSizeHeading3,defaultPadding:`${t.paddingContentVerticalSM}px 12px`,withDescriptionPadding:`${t.paddingMD}px ${t.paddingContentHorizontalLG}px`}),He=oe("Alert",t=>[Oe(t),Be(t),Pe(t)],Ae);var A=function(t,o){var n={};for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&o.indexOf(e)<0&&(n[e]=t[e]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,e=Object.getOwnPropertySymbols(t);a<e.length;a++)o.indexOf(e[a])<0&&Object.prototype.propertyIsEnumerable.call(t,e[a])&&(n[e[a]]=t[e[a]]);return n};const De={success:Ee,info:je,error:ce,warning:Me},_e=t=>{const{icon:o,prefixCls:n,type:e}=t,a=De[e]||null;return o?le(o,i.createElement("span",{className:`${n}-icon`},o),()=>({className:I(`${n}-icon`,{[o.props.className]:o.props.className})})):i.createElement(a,{className:`${n}-icon`})},ke=t=>{const{isClosable:o,prefixCls:n,closeIcon:e,handleClose:a,ariaProps:l}=t,d=e===!0||e===void 0?i.createElement(ze,null):e;return o?i.createElement("button",Object.assign({type:"button",onClick:a,className:`${n}-close-icon`,tabIndex:0},l),d):null},_=i.forwardRef((t,o)=>{const{description:n,prefixCls:e,message:a,banner:l,className:d,rootClassName:m,style:g,onMouseEnter:f,onMouseLeave:v,onClick:h,afterClose:b,showIcon:y,closable:c,closeText:j,closeIcon:N,action:w,id:L}=t,F=A(t,["description","prefixCls","message","banner","className","rootClassName","style","onMouseEnter","onMouseLeave","onClick","afterClose","showIcon","closable","closeText","closeIcon","action","id"]),[E,T]=i.useState(!1),M=i.useRef(null);i.useImperativeHandle(o,()=>({nativeElement:M.current}));const{getPrefixCls:U,direction:G,alert:r}=i.useContext(se),u=U("alert",e),[W,V,J]=He(u),X=p=>{var x;T(!0),(x=t.onClose)===null||x===void 0||x.call(t,p)},z=i.useMemo(()=>t.type!==void 0?t.type:l?"warning":"info",[t.type,l]),Q=i.useMemo(()=>typeof c=="object"&&c.closeIcon||j?!0:typeof c=="boolean"?c:N!==!1&&N!==null&&N!==void 0?!0:!!(r!=null&&r.closable),[j,N,c,r==null?void 0:r.closable]),R=l&&y===void 0?!0:y,q=I(u,`${u}-${z}`,{[`${u}-with-description`]:!!n,[`${u}-no-icon`]:!R,[`${u}-banner`]:!!l,[`${u}-rtl`]:G==="rtl"},r==null?void 0:r.className,d,m,J,V),K=ae(F,{aria:!0,data:!0}),Y=i.useMemo(()=>{var p,x;return typeof c=="object"&&c.closeIcon?c.closeIcon:j||(N!==void 0?N:typeof(r==null?void 0:r.closable)=="object"&&(!((p=r==null?void 0:r.closable)===null||p===void 0)&&p.closeIcon)?(x=r==null?void 0:r.closable)===null||x===void 0?void 0:x.closeIcon:r==null?void 0:r.closeIcon)},[N,c,j,r==null?void 0:r.closeIcon]),Z=i.useMemo(()=>{const p=c??(r==null?void 0:r.closable);return typeof p=="object"?A(p,["closeIcon"]):{}},[c,r==null?void 0:r.closable]);return W(i.createElement(re,{visible:!E,motionName:`${u}-motion`,motionAppear:!1,motionEnter:!1,onLeaveStart:p=>({maxHeight:p.offsetHeight}),onLeaveEnd:b},(p,x)=>{let{className:ee,style:te}=p;return i.createElement("div",Object.assign({id:L,ref:ie(M,x),"data-show":!E,className:I(q,ee),style:Object.assign(Object.assign(Object.assign({},r==null?void 0:r.style),g),te),onMouseEnter:f,onMouseLeave:v,onClick:h,role:"alert"},K),R?i.createElement(_e,{description:n,icon:t.icon,prefixCls:u,type:z}):null,i.createElement("div",{className:`${u}-content`},a?i.createElement("div",{className:`${u}-message`},a):null,n?i.createElement("div",{className:`${u}-description`},n):null),w?i.createElement("div",{className:`${u}-action`},w):null,i.createElement(ke,{isClosable:Q,prefixCls:u,closeIcon:Y,handleClose:X,ariaProps:Z}))}))});function Le(t,o,n){return o=O(o),de(t,me()?Reflect.construct(o,n||[],O(t).constructor):o.apply(t,n))}let Fe=function(t){function o(){var n;return pe(this,o),n=Le(this,o,arguments),n.state={error:void 0,info:{componentStack:""}},n}return fe(o,t),ue(o,[{key:"componentDidCatch",value:function(e,a){this.setState({error:e,info:a})}},{key:"render",value:function(){const{message:e,description:a,id:l,children:d}=this.props,{error:m,info:g}=this.state,f=(g==null?void 0:g.componentStack)||null,v=typeof e>"u"?(m||"").toString():e,h=typeof a>"u"?f:a;return m?i.createElement(_,{id:l,type:"error",message:v,description:i.createElement("pre",{style:{fontSize:"0.9em",overflowX:"auto"}},h)}):d}}])}(i.Component);const k=_;k.ErrorBoundary=Fe;const Te=({avatarHash:t})=>{const o=t?`${P}?seed=${t}`:`${P}?seed=default`;return s.jsx("div",{className:"flex justify-center w-full mb-6",children:s.jsx("div",{className:"w-36 h-36 rounded-full overflow-hidden shadow-xl",children:s.jsx("img",{src:o,className:"w-full h-full object-cover",alt:"avatar"})})})};function Ue(t){return D({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.033 8 8 119.033 8 256s111.033 248 248 248 248-111.033 248-248S392.967 8 256 8zm0 48c110.532 0 200 89.451 200 200 0 110.532-89.451 200-200 200-110.532 0-200-89.451-200-200 0-110.532 89.451-200 200-200m140.204 130.267l-22.536-22.718c-4.667-4.705-12.265-4.736-16.97-.068L215.346 303.697l-59.792-60.277c-4.667-4.705-12.265-4.736-16.97-.069l-22.719 22.536c-4.705 4.667-4.736 12.265-.068 16.971l90.781 91.516c4.667 4.705 12.265 4.736 16.97.068l172.589-171.204c4.704-4.668 4.734-12.266.067-16.971z"},child:[]}]})(t)}const Ge=({isEdit:t,dirtyFields:o,isValid:n,setIsEdit:e,isUpdating:a})=>{const l="absolute top-4 right-5 p-0 m-0 bg-transparent border-none",d=`${l} ${!n||JSON.stringify(o)==="{}"?"opacity-30 cursor-not-allowed":"opacity-100 cursor-pointer"}`,m=!n||JSON.stringify(o)==="{}";return t?s.jsx("button",{type:"submit",className:d,disabled:m||a,children:s.jsx(Ue,{size:35,color:m?"#808080":"#0E8B57"})}):s.jsx("button",{className:l,onClick:()=>e(!0),children:s.jsx($e,{size:35,color:"#885028",className:"cursor-pointer"})})};function We(t){return D({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 48a208 208 0 1 1 0 416 208 208 0 1 1 0-416zm0 464A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM160 152l0 112 0 96c0 13.3 10.7 24 24 24s24-10.7 24-24l0-72 60.9 0 37.2 81.9c5.5 12.1 19.7 17.4 31.8 11.9s17.4-19.7 11.9-31.8L315.7 275c21.8-14.3 36.3-39 36.3-67c0-44.2-35.8-80-80-80l-88 0c-13.3 0-24 10.7-24 24zm48 88l0-64 64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32l-64 0z"},child:[]}]})(t)}const Ve=t=>t?new Date(t).toLocaleString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"Дата не указана",Je=({isEditing:t,control:o,reset:n,user:e,setIsEdit:a})=>{const l=()=>{n({firstName:(e==null?void 0:e.firstName)||"",lastName:(e==null?void 0:e.lastName)||"",email:(e==null?void 0:e.email)||""}),a(!1)};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"text-base mb-4 font-medium",children:"Информация о пользователе"}),s.jsx(Ne,{className:"my-0"}),t?s.jsxs("div",{children:[s.jsx(C,{control:o,label:"Имя",name:"firstName",placeholder:"Имя",rules:S.name}),s.jsx(C,{control:o,name:"lastName",placeholder:"Фамилия",label:"Фамилия",rules:S.surname}),s.jsx(C,{control:o,name:"email",label:"Email",placeholder:"Email",rules:S.email}),s.jsx(ge,{onClick:l,color:"danger",variant:"filled",icon:s.jsx(we,{size:15}),className:"w-full",children:"Отменить изменения"})]}):s.jsxs("div",{className:"flex flex-col items-start gap-2",children:[s.jsxs("div",{className:"flex gap-2 items-start justify-start mb-4",children:[s.jsx(Ce,{size:20}),s.jsx("span",{className:"w-full break-all text-left",children:e==null?void 0:e.firstName})]}),s.jsxs("div",{className:"flex gap-2 items-start justify-start mb-4",children:[s.jsx(Se,{size:20}),s.jsx("span",{className:"w-full break-all text-left",children:e==null?void 0:e.lastName})]}),s.jsxs("div",{className:"flex gap-2 items-start justify-start mb-4",children:[s.jsx(Ie,{size:20}),s.jsx("span",{className:"w-full break-all text-left",children:e==null?void 0:e.email})]}),s.jsxs("div",{className:"flex gap-2 items-start justify-start mb-4",children:[s.jsx(We,{size:20}),`Дата регистрации: ${Ve(e==null?void 0:e.createdAt)}`]})]})]})},st=()=>{const[t,o]=i.useState(!1),n=localStorage.getItem("user"),{data:e,error:a,isLoading:l}=ve(n||"",{skip:!n}),{control:d,handleSubmit:m,formState:{isValid:g,dirtyFields:f},reset:v}=ye({mode:"onChange"}),[h,{isLoading:b}]=xe(),y=async c=>{if(JSON.stringify(f)!=="{}"&&n)try{await h({id:n,data:c}).unwrap(),B.success("Данные успешно обновлены"),o(!1)}catch(j){B.error("Не удалось обновить данные"),console.error("Ошибка обновления данных:",j)}};return i.useEffect(()=>{e&&v({firstName:(e==null?void 0:e.firstName)||"",lastName:(e==null?void 0:e.lastName)||"",email:(e==null?void 0:e.email)||""})},[e]),i.useEffect(()=>{document.title="Профиль"},[]),!e||l||b?s.jsx(he,{}):s.jsx("div",{className:"flex justify-center p-4 break-words w-full",children:s.jsx(be,{className:"w-1/2 px-5 py-5 text-center",style:{zIndex:10},children:a?s.jsx(k,{message:"Ошибка загрузки данных",description:"Не удалось получить информацию о пользователе",type:"error",showIcon:!0}):s.jsx("div",{className:"",children:s.jsxs(Re,{onFinish:m(y),className:"w-full flex flex-col gap-4 text-center",children:[s.jsx(Ge,{isEdit:t,dirtyFields:f,isValid:g,setIsEdit:o,isUpdating:b}),s.jsx(Te,{avatarHash:e==null?void 0:e.avatarHash}),s.jsx(Je,{isEditing:t,control:d,reset:v,user:e,setIsEdit:o})]})})})})};export{st as Me};
